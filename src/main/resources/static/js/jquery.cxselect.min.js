(function(a){a.fn.cxSelect=function(b){if(this.length<1){return};b=a.extend({},a.cxSelect.defaults,b);if(!b.selects.length){return};var c=this;var d=[];var e=b.selects.length;var f;var g;var h=function(n){return(b.required)?n:n-1};var i=function(n,o){var p=o||"请选择";var q;if(!b.required){q="<option value='0'>"+p+"</option>"};a.each(n,function(r,s){if(typeof(s.v)=="undefined"||!s.v){q+="<option value='"+s.n+"'>"+s.n+"</option>"}else{q+="<option value='"+s.v+"'>"+s.n+"</option>"}});return q};var j=[];var k=function(){for(var n=0;n<e;n++){d.push(c.find("select."+b.selects[n]))};g=i(f,d[0].data("title"));d[0].html(g);for(var n=0;n<e;n++){if(d[n].data("val")){j.push(n)}else if(d[n].attr("disabled")){if(b.nodata=="none"){d[n].css("display","none")}else if(b.nodata=="hidden"){d[n].css("visibility","hidden")}}};c.delegate("select","change",function(){m(this.className)});d[0].change();l()};var l=function(n){if(!j.length){return};var o=n||0;if(o<j.length){setTimeout(function(){d[o].val(d[o].data("val")).trigger("change");o++;l(o)},1)}};var m=function(n){var o=[];var p;var q;var r;for(var s=0;s<e;s++){o.push(h(d[s].get(0).selectedIndex));if(p||s>p){d[s].empty().attr("disabled",true);if(b.nodata=="none"){d[s].css("display","none")}else if(b.nodata=="hidden"){d[s].css("visibility","hidden")}};if(n.indexOf(b.selects[s])>-1){p=s}};q=p+1;r=f;for(var s=0;s<q;s++){if(typeof(r[o[s]])=="undefined"||!r[o[s]].s||!r[o[s]].s.length){return;break};r=r[o[s]].s};if(d[q]){g=i(r,d[q].data("title"));d[q].html(g).attr("disabled",false).css({"display":"","visibility":""})}};if(typeof(b.data_json)=='object'){f=b.data_json;k()}else{a.getJSON(b.url,function(n){f=n;k()})}};a.cxSelect={defaults:{url:"js/city.js",selects:[],nodata:null,required:false}}})(jQuery);